(let ((ms qub::makeState2D)
      (origin (qub::makePoint2D 0 0)))
  (qtest::runSuites
    ; qub::makePoint2D
    (qtest::TestSuite ()
      (qtest::TestCase make_an_instance_w_lst
        (qtest::assertIsInstance (ms 0 (list 0 0)) 'qub::State2D))
      (qtest::TestCase make_instance_w_pos
        (qtest::assertIsInstance (ms 0 (qub::makePoint2D 0 0)) 
                                 'qub::State2D)))
    ; qub::move2D
    (qtest::TestSuite ((f qub::move2D))
      (qtest::TestCase move_forward
        (qtest::assertEqual (ms 0 (list 10 0)) (f (ms 0 origin) 10)))
      (qtest::TestCase move_backward
        (qtest::assertEqual (ms 0 origin) (f (ms 0 (list 5 0)) -5)))
      (qtest::TestCase move_north
        (qtest::assertEqual (ms 90 (list 0 5)) (f (ms 90 origin) 5)))
      (qtest::TestCase move_north_east
        (let ((ref (get_pos (ms 45 (list 0.707 0.707))))
              (tst (get_pos (f (ms 45 origin) 1))))
          (qtest::assertAlmostEqual ref tst ?abs_tol 1m)))
      (qtest::TestCase move_south_west
        (let ((ref (get_pos (ms 225 (list -0.707 -0.707))))
              (tst (get_pos (f (ms 225 origin) 1))))
          (qtest::assertAlmostEqual ref tst ?abs_tol 1m))))))